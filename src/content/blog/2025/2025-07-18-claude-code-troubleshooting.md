---
title: '実録 Claude Code 逆引き辞典 - AIとの対話で開発を加速するTips集'
description: '昨日の記事で紹介したCLI型AIコーディングエージェント。今回はその中核ツールである Claude Code について、具体的な使い方を逆引き形式で徹底解説します。'
pubDate: "2025-07-18"
slug: "claude-code-troubleshooting"
tags: ["Claude", "AI", "Development", "CLI"]
category: "開発ツール"
author: "arstella-team"
---

## はじめに

昨日の記事「[AIコーディングエージェントと共に変わる開発スタイル](/blog/coding-with-ai-agents)」では、様々なAIコーディングエージェントのタイプと、私がなぜCLI型のエージェント、特に `Claude Code` を開発の主軸に据えているかをお話ししました。

今回はその続編として、`Claude Code` を実際に使いこなすための、より具体的なテクニックを「逆引き辞典」の形式でご紹介します。
「こんな時どうするんだっけ？」という疑問を解決し、AIとの共同作業をさらにスムーズにするためのTips集です。

## 基本的な操作

まずは、`Claude Code` を使い始める上で基本となる操作についてです。

### 対話を開始したい

`Claude Code` との対話は、ターミナルから簡単に始めることができます。

**手順**

1. ターミナルを開き、`cd` コマンドで対象のプロジェクトディレクトリに移動します。
2. `claude` と入力し、Enterキーを押します。

```bash
# ターミナル
cd /path/to/your-project
claude
```

`>` というプロンプトが表示されたら準備完了です。
自由に話しかけてみましょう。

### 対話を終了したい

対話モードは、いつでも安全に終了できます。

**方法**

`Ctrl+C` を2回連続で押すか、`/exit` と入力してEnterキーを押してください。

### 以前の作業を再開したい

一度終了したセッションも、簡単なコマンドで再開できます。
最初から説明し直す必要はありません。

- **直前のセッションを再開する場合**
  ```bash
  claude -c
  # または
  claude --continue
  ```
- **過去のセッション一覧から選んで再開する場合**
  ```bash
  claude -r
  # または
  claude --resume
  ```

### 話の文脈をリセットしたい

前の指示を引きずってしまい、話が噛み合わなくなることがあります。
そんな時は、会話の文脈をリセットしましょう。

**コマンド**

```
> /clear
```
新しいタスクに移る前や、`claude` の応答が混乱していると感じた時に使うと、頭をスッキリさせてくれます。

### 利用モデルを確認・変更したい

`Claude Code` では、タスクに応じて最適なAIモデルを選択できます。

- **モデルの一覧と現在のモデルを確認**
  ```
  > /model
  ```
- **モデルを切り替える**
  ```
  > /model opus
  ```
  `opus` や `sonnet` のように、使いたいモデル名を指定します。
  一般的に、複雑なタスクにはより高性能な `opus` を、速度とのバランスを取りたい場合は `sonnet` を選択するのがおすすめです。

## プロンプト・指示のコツ

`Claude Code` を使いこなすキモは、なんといってもプロンプト（指示）の出し方です。
ここでは、より的確な応答を引き出すためのコツをご紹介します。

### 指示が長すぎて無視される場合

一度に多くのことを指示しすぎると、`claude` がタスクの一部を忘れてしまうことがあります。

**解決策**

タスクを小さなステップに分割し、段階的に指示しましょう。
また、プロジェクトの全体像や共通ルールは `CLAUDE.md` ファイルに記述しておくことで、毎回説明する手間が省け、プロンプトを簡潔にできます。

```
# 良くない例：一度に全てを詰め込んでいる
> 「src/components/Button.tsx」を作成して、propsとしてvariant(primary/secondary), size(small/medium/large)を受け取れるようにして、tailwindでスタイリングして、storybookのファイルも作って、テストも書いてください。

# 良い例：タスクを分割している
> 「src/components/Button.tsx」を作成してください。propsとしてvariant(primary/secondary)とsize(small/medium/large)を受け取れるようにしてください。
> 
> （Button.tsxが作成された後）
> 今作成したButtonコンポーネントを、tailwindを使ってスタイリングしてください。variantとsizeに応じて見た目が変わるようにしてください。
```

### 複数ファイルを一度に修正したい

複数のファイルにまたがる変更も、globパターンを使えば一度に指示できます。

**プロンプト例**

```
> src/components/**/*.tsx ファイルにある "import React from 'react'" の記述を削除してください。
```
このように対象ファイルを明確に示すことで、`claude` は効率的に作業を行ってくれます。

### 見当違いな修正をしてくる場合

まずは `/clear` で文脈をリセットするのが有効です。
それでも改善しない場合は、指示の具体性が足りないのかもしれません。

- **より具体的に指示する**
  「これをいい感じにして」ではなく、「この関数の命名を、キャメルケース規約に沿って修正してください」のように、具体的な行動を促します。
- **手本を見せる**
  「この `src/utils/logger.ts` のような形式で、新しいユーティリティ関数を作成してください」のように、参考にしてほしい既存のコードを提示すると、`claude` はプロジェクトのスタイルを学習しやすくなります。

## ファイルとコードの操作

ファイルの作成やコードの編集でよくある疑問にお答えします。

### 作成したファイルの保存場所がわからない

意図しない場所にファイルが作成されるのを防ぐため、保存場所は明確に指定しましょう。

**解決策**

プロジェクトのルートディレクトリからの相対パス、または絶対パスで指示すると確実です。

```
> src/hooks/useAuth.ts というファイルを作成してください。
```

### 生成されたコードのスタイルが既存のものと違う

`claude` にプロジェクトのコーディング規約を学習させましょう。

**解決策**

リンターの存在を教え、実行を指示するのが効果的です。

```
> このプロジェクトではESLintとPrettierを導入しています。それらのルールに従って、先ほど生成したコードをフォーマットしてください。
> 
> または
> 
> `npx eslint --fix .` を実行して、コード全体をフォーマットしてください。
```

## ツール連携と環境設定

Git やパッケージマネージャーなど、他のツールとの連携に関する設定です。

### `npm install` などのシェルコマンドを実行させたい

セキュリティのため、`claude` はデフォルトでシェルコマンドの実行前に許可を求めます。
これを効率化することができます。

**解決策**

毎回許可するのが面倒な場合は、プロジェクトのルートに `.claude/settings.json` を作成し、特定のコマンドを許可リストに登録しましょう。

```json
{
  "permissions": {
    "shell": {
      "allowed": [
        "npm install",
        "npx eslint --fix ."
      ]
    }
  }
}
```

### 生成されるGitのコミットメッセージをカスタマイズしたい

コミットメッセージのスタイルも、プロンプトで指示できます。

**解決策**

`Conventional Commits` のような規約を明示して、それに従うよう依頼します。

```
> ここまでの変更をコミットしてください。コミットメッセージは "feat: ユーザー認証機能の追加" のように、Conventional Commits の規約に従ってください。
```

また、`CLAUDE.md` に「コミットはConventional Commitsに従うこと」と記述しておくのも、長期的に見て非常に有効な方法です。

## トラブルシューティング

よくあるエラーとその対処法をまとめました。

### 「Permission denied」エラーが出る

ファイルの作成や編集時に権限エラーが発生することがあります。

**解決策**

- プロジェクトディレクトリの権限を確認してください
- 必要に応じて `sudo` を使用するか、ディレクトリの所有者を変更してください

### claudeコマンドが見つからない

`claude: command not found` というエラーが表示される場合があります。

**解決策**

1. Claude Codeが正しくインストールされているか確認
   ```bash
   which claude
   ```
2. パスが通っているか確認
   ```bash
   echo $PATH
   ```
3. 必要に応じて再インストール

### レスポンスが遅い・タイムアウトする

大規模なプロジェクトや複雑なタスクでレスポンスが遅くなることがあります。

**解決策**

- より軽量なモデル（sonnet）に切り替える
- タスクを小さく分割する
- 不要なファイルを `.claudeignore` に追加してコンテキストを減らす

## パフォーマンス向上のTips

### コンテキストの最適化

`.claudeignore` ファイルを活用して、不要なファイルを除外しましょう。

```
# .claudeignore の例
node_modules/
dist/
*.log
.git/
coverage/
```

### モデルの使い分け

- **簡単なタスク**: `sonnet` を使用（高速）
- **複雑なリファクタリング**: `opus` を使用（高精度）
- **コードレビュー**: `opus` を推奨

### セッションの管理

長時間の作業では定期的に `/clear` でコンテキストをリセットすることで、パフォーマンスを維持できます。

## セキュリティに関する注意事項

### 機密情報の取り扱い

- APIキーや認証情報は絶対にプロンプトに含めない
- `.env` ファイルは必ず `.claudeignore` に追加する
- 機密性の高いコードを扱う際は、ローカルモデルの使用を検討する

### シェルコマンドの実行

- 不明なコマンドの実行は避ける
- `rm -rf` などの破壊的なコマンドは特に注意
- 必要最小限の権限で実行する

## まとめ

`Claude Code` は、使い方や指示のコツを掴むことで、開発効率を飛躍的に向上させてくれる可能性を秘めています。
最初は少し戸惑うかもしれませんが、対話を重ねることで、徐々に頼れるパートナーになっていくはずです。

昨日の記事と合わせてお読みいただくことで、AIコーディングエージェントの全体像から具体的な活用法まで、より深くご理解いただけたなら幸いです。